version: "3.8"

services:
  letsrenew:
    build:
      context: .
      dockerfile: Dockerfile
    image: letsrenew:local
    restart: unless-stopped
    ports:
      - "8080:8080" # status server port (change if needed)
    environment:
      - LETSRENEW_CONFIG=/etc/letsrenew/config.yml
      - HOME=/home/letsrenew
    user: "${LOCAL_UID:-1000}:${LOCAL_GID:-1000}"
    volumes:
      - "./data/letsrenew:/data/letsrenew:rw"                      # default host path for cert storage (repo-local)
      - "./container/etc/letsrenew:/etc/letsrenew:ro"     # default config dir to mount (repo-local)
      - "./host-ssh-config:/home/letsrenew/.ssh:ro"         # default host SSH config dir (repo-local) mounted into container HOME
      - "./container/home/letsrenew:/home/letsrenew:ro"   # mount example home into container and set $HOME
    command: ["bun", "src/cli.ts"]

# To override defaults, set LOCAL_UID/LOCAL_GID or edit the volume lines above.

networks:
  default:
    driver: bridge
