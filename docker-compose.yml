version: "3.8"

services:
  letsrenew:
    build:
      context: .
      dockerfile: Dockerfile
    image: letsrenew:local
    restart: unless-stopped
    ports:
      - "${LETSRENEW_STATUS_PORT:-8080}:8080"
    environment:
      - LETSRENEW_CONFIG=/etc/letsrenew/config.yml
    volumes:
      - "${HOST_CERT_DIR:-/var/lib/letsrenew/certs}:/data/certs:rw"
      - "${HOST_LETSRENEW_CONFIG:-/etc/letsrenew}:/etc/letsrenew:ro"
      - "${HOST_SSH_CONFIG:-/opt/letsrenew/host-ssh-config}:/root/.ssh:ro"
    command: ["bun", "src/cli.ts"]

